"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["unzer-payment6"],{2832:(e,t,n)=>{var i=n(6285);function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class s extends i.Z{init(){this._registerElements(),this._registerEvents()}_registerElements(){let e=null;null!==this.options.shopLocale&&(e={locale:this.options.shopLocale}),this.unzerInstance=new window.unzer(this.options.publicKey,e),this.options.isOrderEdit?this.submitButton=document.getElementById(this.options.confirmFormId).getElementsByTagName("button")[0]:this.submitButton=document.getElementById(this.options.submitButtonId),this.confirmForm=document.getElementById(this.options.confirmFormId)}_registerEvents(){this.submitButton.addEventListener("click",this._onSubmitButtonClick.bind(this))}setSubmitButtonActive(e){e?(this.submitButton.classList.remove(this.options.disabledClass),this.submitButton.disabled=!1):(this.submitButton.classList.add(this.options.disabledClass),this.submitButton.disabled=!0)}submitResource(e){document.getElementById(this.options.resourceIdElementId).value=e.id,this.setSubmitButtonActive(!0),this.submitButton.click(),this.setSubmitButtonActive(!1)}submitTypeId(e){document.getElementById(this.options.resourceIdElementId).value=e,this.setSubmitButtonActive(!0),this.submitButton.click(),this.setSubmitButtonActive(!1)}showError(e,t=!1){const n=document.getElementsByClassName(this.options.errorWrapperClass).item(0),i=document.querySelectorAll(this.options.errorContentSelector)[0];t&&""!==i.innerText?i.innerText=`${i.innerText}\n${e.message}`:i.innerText=e.message,n.hidden=!1,n.scrollIntoView({block:"end",behavior:"smooth"}),this.setSubmitButtonActive(!0)}renderErrorToElement(e,t){const n=document.getElementsByClassName(this.options.errorWrapperClass).item(0),i=document.querySelectorAll(this.options.errorContentSelector)[0];n.hidden=!1,i.innerText=e.message,t.appendChild(n)}_onSubmitButtonClick(e){!0!==this.submitting&&(this.submitting=!0,e.preventDefault(),this._validateForm()?(this.setSubmitButtonActive(!1),this.$emitter.publish("unzerBase_createResource")):this.setSubmitButtonActive(!0))}_validateForm(){let e=!0;const t=document.forms[this.options.confirmFormId].elements;this._clearErrorMessage();for(let n=0;n<t.length;n++){const i=t[n];if(!i.checkValidity())return i.dataset.customError&&this.showError({message:i.dataset.customError}),i.classList.add("is-invalid"),!1;i.required&&""===i.value?(i.classList.add("is-invalid"),0===i.labels.length&&e?i.scrollIntoView({block:"end",behavior:"smooth"}):i.labels.length>0&&this.showError({message:this.options.errorShouldNotBeEmpty.replace(/%field%/,i.labels[0].innerText)},!0),e=!1):i.classList.remove("is-invalid")}return e}_clearErrorMessage(){const e=document.getElementsByClassName(this.options.errorWrapperClass).item(0),t=document.querySelectorAll(this.options.errorContentSelector)[0];e.hidden=!0,t.innerText=""}getB2bCustomerObject(e){const t=`${e.firstName} ${e.lastName}`,n=e.birthday?new Date(e.birthday):null,i={firstname:e.firstName,lastname:e.lastName,email:e.email,company:e.activeBillingAddress.company,salutation:e.salutation.salutationKey,billingAddress:{name:t,street:e.activeBillingAddress.street,zip:e.activeBillingAddress.zipcode,city:e.activeBillingAddress.city,country:e.activeBillingAddress.country.iso},shippingAddress:{name:t,street:e.activeShippingAddress.street,zip:e.activeShippingAddress.zipcode,city:e.activeShippingAddress.city,country:e.activeShippingAddress.country.iso}};return n&&(i.birthDate=n.getFullYear()+"-"+(n.getMonth()+1).toString().padStart(2,"0")+"-"+n.getDay().toString().padStart(2,"0")),i}}r(s,"options",{publicKey:null,shopLocale:null,submitButtonId:"confirmFormSubmit",disabledClass:"disabled",resourceIdElementId:"unzerResourceId",confirmFormId:"confirmOrderForm",errorWrapperClass:"unzer-payment--error-wrapper",errorContentSelector:".unzer-payment--error-wrapper .alert-content",errorShouldNotBeEmpty:"%field% should not be empty",isOrderEdit:!1}),r(s,"submitting",!1),r(s,"unzerInstance",null);var a=n(3206);function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class u extends i.Z{init(){if(this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this._createForm(),this._registerEvents(),this.options.hasSavedCards){a.Z.querySelector(this.el,this.options.elementWrapperSelector).hidden=!0}else this._unzerPaymentPlugin.setSubmitButtonActive(!1)}_createForm(){this.creditCard=this._unzerPaymentPlugin.unzerInstance.Card(),this.creditCard.create("number",{containerId:this.options.numberFieldInputId,onlyIframe:!0}),this.creditCard.create("expiry",{containerId:this.options.expiryFieldId,onlyIframe:!0}),this.creditCard.create("cvc",{containerId:this.options.cvcFieldId,onlyIframe:!0}),this.creditCard.addEventListener("change",this._onChangeForm.bind(this))}_registerEvents(){if(this.options.hasSavedCards){const e=a.Z.querySelectorAll(this.el,this.options.radioButtonSelector);for(let t=0;t<e.length;t++)e[t].addEventListener("change",(e=>this._onRadioButtonChange(e)))}this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this})}_onRadioButtonChange(e){const t=e.target;a.Z.querySelector(this.el,this.options.elementWrapperSelector).hidden=t.id!==this.options.radioButtonNewId,t.id===this.options.radioButtonNewId?this._unzerPaymentPlugin.setSubmitButtonActive(!0===this.cvcValid&&!0===this.numberValid&&!0===this.expiryValid):this._unzerPaymentPlugin.setSubmitButtonActive(!0)}_onChangeForm(e){if(e.cardType){let t=this.options.placeholderBrandImageUrl;return"unknown"!==e.cardType.type&&(t=this._getBrandImageUrl(e.cardType.type)),void(document.getElementById(this.options.iconFieldId).src=t)}if(!e.type||this.submitting)return;const t=this._getInputElementByEvent(e),n=this._getErrorElementByEvent(e);if(!1===e.success?(t.classList.add(this.options.invalidClass),n.hidden=!1):!0===e.success&&(t.classList.remove(this.options.invalidClass),n.hidden=!0),e.error){n.getElementsByClassName("unzer-error-message")[0].innerText=e.error}"cvc"===e.type?this.cvcValid=e.success:"number"===e.type?this.numberValid=e.success:"expiry"===e.type&&(this.expiryValid=e.success),this._unzerPaymentPlugin.setSubmitButtonActive(!0===this.cvcValid&&!0===this.numberValid&&!0===this.expiryValid)}_onCreateResource(){let e=null;this.options.hasSavedCards&&(e=a.Z.querySelector(this.el,this.options.selectedRadioButtonSelector)),this.submitting=!0,this._unzerPaymentPlugin.setSubmitButtonActive(!1),null===e||e.id===this.options.radioButtonNewId?this.creditCard.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e))):this._unzerPaymentPlugin.submitTypeId(e.value)}_getInputElementByEvent(e){const t=`#unzer-payment-credit-card-${e.type}`;return a.Z.querySelector(this.el,t)}_getErrorElementByEvent(e){const t=`#unzer-payment-credit-card-${e.type}-error`;return a.Z.querySelector(this.el,t)}_submitPayment(e){this._unzerPaymentPlugin.submitResource(e)}_handleError(e){this._unzerPaymentPlugin.showError(e)}_getBrandImageUrl(e){return`https://static.unzer.com/assets/images/brands/${e}.svg`}}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}o(u,"options",{numberFieldId:"unzer-payment-credit-card-number",numberFieldInputId:"unzer-payment-credit-card-number-input",expiryFieldId:"unzer-payment-credit-card-expiry",cvcFieldId:"unzer-payment-credit-card-cvc",iconFieldId:"unzer-payment-credit-card-icon",invalidClass:"is-invalid",elementWrapperSelector:".unzer-payment-credit-card-wrapper-elements",radioButtonSelector:'*[name="savedCreditCard"]',radioButtonNewId:"card-new",selectedRadioButtonSelector:'*[name="savedCreditCard"]:checked',hasSavedCards:!1,placeholderBrandImageUrl:"https://static.unzer.com/assets/images/common/group-5.svg"}),o(u,"creditCard",void 0),o(u,"submitting",!1),o(u,"_unzerPaymentPlugin",null);class l extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.eps=this._unzerPaymentPlugin.unzerInstance.EPS(),this._createForm(),this._registerEvents()}_createForm(){this.eps.create("eps",{containerId:"unzer-payment-eps-container"})}_registerEvents(){this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this})}_onCreateResource(){this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.eps.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e)))}_submitPayment(e){this._unzerPaymentPlugin.submitResource(e)}_handleError(e){this._unzerPaymentPlugin.showError(e)}}c(l,"eps",void 0),c(l,"_unzerPaymentPlugin",null);var m=n(4690);function d(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.installmentSecured=this._unzerPaymentPlugin.unzerInstance.InstallmentSecured(),this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.birthdateContainer=document.getElementById(this.options.birthdateContainerIdSelector),this.birthdateInput=document.getElementById(this.options.birthdateInputIdSelector),this.unzerInputsValid=!1,this._createForm(),this._registerEvents()}_createForm(){const e=document.getElementById(this.options.formLoadingIndicatorElementId);m.Z.create(e),this.installmentSecured.create({containerId:"unzer-payment-installment-secured-container",amount:this.options.installmentSecuredAmount.toFixed(4),currency:this.options.installmentSecuredCurrency,effectiveInterest:this.options.installmentSecuredEffectiveInterest,orderDate:this.options.installmentSecuredOrderDate}).then((()=>{e.hidden=!0})).catch((t=>{this._unzerPaymentPlugin.renderErrorToElement(t,e),this._unzerPaymentPlugin.setSubmitButtonActive(!1)})).finally((()=>{m.Z.remove(e)}))}_registerEvents(){this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this}),this.installmentSecured.addEventListener("installmentSecuredEvent",(e=>this._onChangeInstallmentSecuredForm(e))),this.birthdateInput.addEventListener("change",this._onBirthdateInputChange.bind(this))}_onCreateResource(){this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.installmentSecured.createResource().then((e=>this._unzerPaymentPlugin.submitResource(e))).catch((e=>this._unzerPaymentPlugin.showError(e)))}_onChangeInstallmentSecuredForm(e){if("validate"===e.action&&(this.unzerInputsValid=e.success,e.success&&this._validateBirthdate()?this._unzerPaymentPlugin.setSubmitButtonActive(!0):this._unzerPaymentPlugin.setSubmitButtonActive(!1)),"plan-detail"===e.currentStep){const e=document.getElementById(this.options.installmentsTotalValueElementId),t=document.getElementById(this.options.installmentsInterestValueElementId);e.innerText=this._formatCurrency(this.installmentSecured.selectedInstallmentPlan.totalAmount)+this.options.starSymbol,t.innerText=this._formatCurrency(this.installmentSecured.selectedInstallmentPlan.totalInterestAmount)+this.options.starSymbol}}_formatCurrency(e){return e.toLocaleString(this.options.currencyFormatLocale,{style:"currency",currency:this.options.currencyIso})}_onBirthdateInputChange(){this._validateBirthdate()&&this.unzerInputsValid?this._unzerPaymentPlugin.setSubmitButtonActive(!0):this._unzerPaymentPlugin.setSubmitButtonActive(!1)}_validateBirthdate(){if(""===this.birthdateInput.value)return!1;const e=new Date(this.birthdateInput.value),t=new Date,n=new Date;e.setHours(0,0,0,0),t.setHours(0,0,0,0),n.setHours(0,0,0,0),t.setDate(t.getDate()+1),n.setFullYear(n.getFullYear()-18);const i=e<=n&&e<t;return i?this.birthdateContainer.classList.remove("error"):this.birthdateContainer.classList.add("error"),i}}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}d(h,"options",{installmentSecuredAmount:0,installmentSecuredCurrency:"",installmentSecuredEffectiveInterest:0,installmentSecuredOrderDate:"",installmentsTotalValueElementId:"unzer-payment-installments-total",installmentsInterestValueElementId:"unzer-payment-installments-interest",formLoadingIndicatorElementId:"element-loader",currencyIso:"EUR",currencyFormatLocale:"en-GB",starSymbol:"*",birthdateInputIdSelector:"unzerPaymentBirthday",birthdateContainerIdSelector:"unzerPaymentBirthdayContainer"}),d(h,"installmentSecured",void 0),d(h,"birthdateContainer",void 0),d(h,"birthdateInput",void 0),d(h,"unzerInputsValid",void 0),d(h,"_unzerPaymentPlugin",null);class y extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.ideal=this._unzerPaymentPlugin.unzerInstance.Ideal(),this._createForm(),this._registerEvents()}_createForm(){this.ideal.create("ideal",{containerId:"unzer-payment-ideal-container"}),this._unzerPaymentPlugin.setSubmitButtonActive(!1)}_registerEvents(){this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this}),this.ideal&&this.ideal.addEventListener("change",(e=>this._onFormChange(e)),{scope:this})}_onFormChange(e){e.value&&this._unzerPaymentPlugin.setSubmitButtonActive(!0)}_onCreateResource(){this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.ideal.createResource().then((e=>this._unzerPaymentPlugin.submitResource(e))).catch((e=>this._unzerPaymentPlugin.showError(e)))}}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}p(y,"ideal",void 0),p(y,"_unzerPaymentPlugin",null);class P extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.invoice=this._unzerPaymentPlugin.unzerInstance.Invoice(),this._registerEvents()}_registerEvents(){this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this})}_onCreateResource(){this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.invoice.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e)))}_submitPayment(e){this._unzerPaymentPlugin.submitResource(e)}_handleError(e){this._unzerPaymentPlugin.showError(e)}}function b(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}g(P,"options",{unzerPaymentCardId:"unzer-payment-card"}),g(P,"invoice",void 0),g(P,"_unzerPaymentPlugin",null);class v extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.invoiceSecured=this._unzerPaymentPlugin.unzerInstance.InvoiceSecured(),this.options.isB2BCustomer&&this._createB2bForm(),this._registerEvents()}_registerEvents(){this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this})}_createB2bForm(){this.b2bCustomerProvider=this._unzerPaymentPlugin.unzerInstance.B2BCustomer(),this.b2bCustomerProvider.b2bCustomerEventHandler=e=>this._onValidateB2bForm(e),this.b2bCustomerProvider.initFormFields(this._unzerPaymentPlugin.getB2bCustomerObject(this.options.customerInfo)),this.b2bCustomerProvider.create({containerId:"unzer-payment-b2b-form",externalCustomerId:this.options.customerInfo.customerNumber})}_onValidateB2bForm(e){this._unzerPaymentPlugin.setSubmitButtonActive(e.success)}_onCreateResource(){this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.options.isB2BCustomer?this.b2bCustomerProvider.createCustomer().then((e=>this._onB2bCustomerCreated(e.id))).catch((e=>this._handleError(e))):this.invoiceSecured.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e)))}_onB2bCustomerCreated(e){document.getElementById("unzerCustomerId").value=e,this.invoiceSecured.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e)))}_submitPayment(e){this._unzerPaymentPlugin.submitResource(e)}_handleError(e){this._unzerPaymentPlugin.showError(e)}}function _(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}b(v,"options",{isB2BCustomer:!1,customerInfo:null}),b(v,"_unzerPaymentPlugin",null),b(v,"invoiceSecured",null),b(v,"b2bCustomerProvider",null);class S extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this._registerEvents()}_registerEvents(){this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()))}_onCreateResource(){const e=document.querySelector(this.options.selectedRadioButtonSelector);null===e||"new"===e.value?this._unzerPaymentPlugin.confirmForm.submit():this._unzerPaymentPlugin.submitTypeId(e.value)}}function z(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}_(S,"options",{radioButtonSelector:'input[name="savedPayPalAccount"]',selectedRadioButtonSelector:'input[name="savedPayPalAccount"]:checked',radioButtonNewSelector:"#new"}),_(S,"submitting",!1),_(S,"_unzerPaymentPlugin",null);class f extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.sepa=this._unzerPaymentPlugin.unzerInstance.SepaDirectDebit(),this.mandateAcceptedCheckbox=document.getElementById(this.options.acceptMandateId),this._createForm(),this._registerEvents(),this.options.hasSepaDevices||this._unzerPaymentPlugin.setSubmitButtonActive(!1)}_createForm(){this.sepa.create("sepa-direct-debit",{containerId:"unzer-payment-sepa-container"})}_registerEvents(){if(this.options.hasSepaDevices){const e=a.Z.querySelectorAll(this.el,this.options.radioButtonSelector);for(let t=0;t<e.length;t++)e[t].addEventListener("change",(e=>this._onRadioButtonChange(e)));document.querySelector(this.options.selectedRadioButtonSelector).dispatchEvent(new Event("change"))}this.sepa.addEventListener("change",(e=>this._onFormChange(e))),this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this})}_onRadioButtonChange(e){const t=e.target;a.Z.querySelector(this.el,this.options.elementWrapperSelector).hidden=t.id!==this.options.radioButtonNewAccountId,t&&t.id!==this.options.radioButtonNewAccountId?(this._unzerPaymentPlugin.setSubmitButtonActive(!0),this.mandateAcceptedCheckbox.required=!1):(this._unzerPaymentPlugin.setSubmitButtonActive(this.sepa.validated),this.mandateAcceptedCheckbox.required=!0)}_onFormChange(e){this._unzerPaymentPlugin.setSubmitButtonActive(e.success)}_onCreateResource(){const e=document.querySelector(this.options.selectedRadioButtonSelector);this.options.hasSepaDevices&&e&&e.id!==this.options.radioButtonNewAccountId?(this._unzerPaymentPlugin.setSubmitButtonActive(!1),this._submitDevicePayment(e.value)):(this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.sepa.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e))))}_submitPayment(e){this._unzerPaymentPlugin.submitResource(e)}_submitDevicePayment(e){this._unzerPaymentPlugin.submitTypeId(e)}_handleError(e){this._unzerPaymentPlugin.showError(e)}}function B(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}z(f,"options",{acceptMandateId:"acceptSepaMandate",elementWrapperSelector:".unzer-payment-sepa-wrapper-elements",radioButtonSelector:'*[name="savedDirectDebitDevice"]',radioButtonNewAccountId:"device-new",selectedRadioButtonSelector:'*[name="savedDirectDebitDevice"]:checked',hasSepaDevices:!1}),z(f,"sepa",void 0),z(f,"_unzerPaymentPlugin",null);class I extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.sepa=this._unzerPaymentPlugin.unzerInstance.SepaDirectDebitSecured(),this.birthDateElement=document.getElementById(this.options.birthDateFieldId),this.mandateAcceptedCheckbox=document.getElementById(this.options.acceptMandateId),this._createForm(),this._registerEvents(),this.options.hasSepaDevices||this._unzerPaymentPlugin.setSubmitButtonActive(!1)}_createForm(){this.sepa.create("sepa-direct-debit-secured",{containerId:"unzer-payment-sepa-container"})}_registerEvents(){if(this.options.hasSepaDevices){const e=a.Z.querySelectorAll(this.el,this.options.radioButtonSelector);for(let t=0;t<e.length;t++)e[t].addEventListener("change",(e=>this._onRadioButtonChange(e)));document.querySelector(this.options.selectedRadioButtonSelector).dispatchEvent(new Event("change"))}this.sepa.addEventListener("change",(e=>this._onFormChange(e))),this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this})}_onRadioButtonChange(e){const t=e.target;a.Z.querySelector(this.el,this.options.elementWrapperSelector).hidden=t.id!==this.options.radioButtonNewAccountId,t&&t.id!==this.options.radioButtonNewAccountId?(this._unzerPaymentPlugin.setSubmitButtonActive(!0),this.birthDateElement.required=!1,this.mandateAcceptedCheckbox.required=!1):(this._unzerPaymentPlugin.setSubmitButtonActive(this.sepa.validated),this.birthDateElement.required=!0,this.mandateAcceptedCheckbox.required=!0)}_onFormChange(e){this._unzerPaymentPlugin.setSubmitButtonActive(e.success)}_onCreateResource(){const e=document.querySelector(this.options.selectedRadioButtonSelector);this.options.hasSepaDevices&&e&&e.id!==this.options.radioButtonNewAccountId?(this._unzerPaymentPlugin.setSubmitButtonActive(!1),this._submitDevicePayment(e.value)):(this._unzerPaymentPlugin.setSubmitButtonActive(!1),this.sepa.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e))))}_submitPayment(e){this._unzerPaymentPlugin.submitResource(e)}_submitDevicePayment(e){this._unzerPaymentPlugin.submitTypeId(e)}_handleError(e){this._unzerPaymentPlugin.showError(e)}}function w(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B(I,"options",{birthDateFieldId:"unzerPaymentBirthday",acceptMandateId:"acceptSepaMandate",elementWrapperSelector:".unzer-payment-sepa-wrapper-elements",radioButtonSelector:'*[name="savedDirectDebitDevice"]',radioButtonNewAccountId:"device-new",selectedRadioButtonSelector:'*[name="savedDirectDebitDevice"]:checked'}),B(I,"sepa",void 0),B(I,"_unzerPaymentPlugin",null);class E extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.paylaterInvoice=this._unzerPaymentPlugin.unzerInstance.PaylaterInvoice(),this.paylaterInvoice.create({containerId:"unzer-payment-paylater-invoice-wrapper",customerType:this.options.isB2BCustomer?"B2B":"B2C"}),this._registerEvents()}_registerEvents(){this._unzerPaymentPlugin.$emitter.subscribe("unzerBase_createResource",(()=>this._onCreateResource()),{scope:this})}_onCreateResource(){this._unzerPaymentPlugin.setSubmitButtonActive(!1),this._createResource()}_createResource(){this.paylaterInvoice.createResource().then((e=>this._submitPayment(e))).catch((e=>this._handleError(e)))}_submitPayment(e){this._unzerPaymentPlugin.submitResource(e)}_handleError(e){this._unzerPaymentPlugin.showError(e)}}w(E,"options",{isB2BCustomer:!1}),w(E,"paylaterInvoice",void 0),w(E,"_unzerPaymentPlugin",null);var C=n(8254),A=n(5659);function R(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class F extends i.Z{init(){this._unzerPaymentPlugin=window.PluginManager.getPluginInstances("UnzerPaymentBase")[0],this.client=new C.Z,this._hasCapability()?(this._createScript(),this._createForm(),this._registerEvents()):this._disableApplePay()}_hasCapability(){return window.ApplePaySession&&window.ApplePaySession.canMakePayments()&&window.ApplePaySession.supportsVersion(6)}_disableApplePay(){a.Z.querySelector(document,this.options.applePayMethodSelector,!1).remove(),a.Z.querySelectorAll(document,"[data-unzer-payment-apple-pay]",!1).forEach((e=>e.remove())),this._unzerPaymentPlugin.showError({message:this.options.noApplePayMessage}),this._unzerPaymentPlugin.setSubmitButtonActive(!1)}_createScript(){const e=document.createElement("script");e.type="text/javascript",e.src="https://applepay.cdn-apple.com/jsapi/v1/apple-pay-sdk.js",document.head.appendChild(e)}_createForm(){this.applePay=this._unzerPaymentPlugin.unzerInstance.ApplePay();a.Z.querySelector(document,this.options.checkoutConfirmButtonSelector).style.display="none"}_startPayment(){const e=this,t={countryCode:this.options.countryCode,currencyCode:this.options.currency,supportedNetworks:this.options.supportedNetworks,merchantCapabilities:["supports3DS"],total:{label:this.options.shopName,amount:this.options.amount}};if(!window.ApplePaySession)return;const n=new window.ApplePaySession(6,t);n.onvalidatemerchant=t=>{try{e.client.post(e.options.merchantValidationUrl,JSON.stringify({merchantValidationUrl:t.validationURL}),(e=>{n.completeMerchantValidation(JSON.parse(e))}))}catch(e){n.abort()}},n.onpaymentauthorized=t=>{const i=t.payment.token.paymentData;e.applePay.createResource(i).then((t=>{e.submitting=!0,A.Z.create();try{e.client.post(e.options.authorizePaymentUrl,JSON.stringify(t),(i=>{"pending"===JSON.parse(i).transactionStatus?(n.completePayment({status:window.ApplePaySession.STATUS_SUCCESS}),e._unzerPaymentPlugin.setSubmitButtonActive(!1),e._unzerPaymentPlugin.submitResource(t)):(A.Z.remove(),n.completePayment({status:window.ApplePaySession.STATUS_FAILURE}),n.abort())}))}catch(e){A.Z.remove(),n.completePayment({status:window.ApplePaySession.STATUS_FAILURE}),n.abort()}})).catch((()=>{A.Z.remove(),n.completePayment({status:window.ApplePaySession.STATUS_FAILURE}),n.abort()})).finally((()=>{e._unzerPaymentPlugin.setSubmitButtonActive(!0),e.submitting=!1}))},n.begin()}_registerEvents(){a.Z.querySelector(document,this.options.applePayButtonSelector).addEventListener("click",this._startPayment.bind(this))}_handleError(e){this._unzerPaymentPlugin.showError(e)}}R(F,"options",{countryCode:"DE",currency:"EUR",shopName:"Unzer GmbH",amount:"0.0",applePayButtonSelector:"apple-pay-button",checkoutConfirmButtonSelector:"#confirmFormSubmit",applePayMethodSelector:".unzer-payment-apple-pay-method-wrapper",authorizePaymentUrl:"",merchantValidationUrl:"",noApplePayMessage:"",supportedNetworks:["masterCard","visa"]}),R(F,"submitting",!1),R(F,"_unzerPaymentPlugin",null),R(F,"applePay",void 0),R(F,"client",void 0),window.PluginManager.register("UnzerPaymentBase",s,"[data-unzer-payment-base]"),window.PluginManager.register("UnzerPaymentCreditCard",u,"[data-unzer-payment-credit-card]"),window.PluginManager.register("UnzerPaymentEps",l,"[data-unzer-payment-eps]"),window.PluginManager.register("UnzerPaymentIdeal",y,"[data-unzer-payment-ideal]"),window.PluginManager.register("UnzerPaymentInvoice",P,"[data-unzer-payment-invoice]"),window.PluginManager.register("UnzerPaymentInvoiceSecured",v,"[data-unzer-payment-invoice-secured]"),window.PluginManager.register("UnzerPaymentInstallmentSecured",h,"[data-unzer-payment-installment-secured]"),window.PluginManager.register("UnzerPaymentPayPal",S,"[data-unzer-payment-paypal]"),window.PluginManager.register("UnzerPaymentSepaDirectDebit",f,"[data-unzer-payment-sepa-direct-debit]"),window.PluginManager.register("UnzerPaymentSepaDirectDebitSecured",I,"[data-unzer-payment-sepa-direct-debit-secured]"),window.PluginManager.register("UnzerPaymentApplePay",F,"[data-unzer-payment-apple-pay]"),window.PluginManager.register("UnzerPaymentPaylaterInvoice",E,"[data-unzer-payment-paylater-invoice]")}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=2832,e(e.s=t);var t}));e.O()}]);